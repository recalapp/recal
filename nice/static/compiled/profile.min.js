function AS_showActionSheetFromElement(d,a,e,f,b){var c=$("<div>");$.each(f,function(g){var h=$("<a>").addClass("white-link-btn").addClass("prompt-btn theme").attr("id",g).text(this.text);if(this.important){h=h.addClass("no")}else{h=h.addClass("yes")}h.on("click",function(j){j.preventDefault();$(d).blur();b(g)});c.append(h)});if(THEME=="w"){c.find(".theme").removeClass("dark")}else{c.find(".theme").addClass("dark")}$(d).popover({title:e,placement:"bottom",html:true,content:c[0],trigger:"focus",container:$(a)});$(d).focus()}var cacheManager=null;var CACHE_INIT=false;function CacheMan_init(){if(CACHE_INIT){return}CACHE_INIT=true;cacheManager=new _CacheMan();if(typeof CACHEMAN_PRELOAD!="undefined"){$.each(CACHEMAN_PRELOAD,function(a,b){cacheManager.cached[a]=b})}}function _CacheMan(){this.cached={};return this}function CacheMan_load(a){if(cacheManager.cached[a]==null){_CacheMan_cacheURL(a,false);return CacheMan_load(a)}return cacheManager.cached[a]}function _CacheMan_cacheURL(a,b){$.ajax(a,{async:b,dataType:"html",success:function(c){cacheManager.cached[a]=c}})}var CAL_LOADING=false;var FACTOR_LUM=0.2;var FACTOR_TRANS=0.7;CAL_INIT=false;Cal_eventSource={events:[]};Cal_options={defaultView:"agendaWeek",slotMinutes:45,firstHour:8,minTime:8,maxTime:23,eventDurationEditable:false,eventStartEditable:false,eventBackgroundColor:"#74a2ca",eventBorderColor:"#428bca",allDayDefault:false,eventSources:[Cal_eventSource],ignoreTimezone:false,allDaySlot:false,slotEventOverlap:true};function Cal_init(){}function Cal_highlightEvent(b,a){if(!b.highlighted){b.backgroundColor=setOpacity(b.backgroundColor,1);b.textColor="#ffffff"}b.highlighted=true;if(a){$("#calendarui").fullCalendar("updateEvent",b)}}function Cal_unhighlightEvent(b,a){if(b.highlighted){b.textColor=b.myColor;b.backgroundColor=setOpacity(b.backgroundColor,FACTOR_TRANS)}b.highlighted=false;if(a){$("#calendarui").fullCalendar("updateEvent",b)}}function colorLuminance(e,a){e=String(e).replace(/[^0-9a-f]/gi,"");if(e.length<6){e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}a=a||0;var b="#",f,d;for(d=0;d<3;d++){f=parseInt(e.substr(d*2,2),16);f=Math.round(Math.min(Math.max(0,f+(f*a)),255)).toString(16);b+=("00"+f).substr(f.length)}return b}function luminanceToRgb(c){var e=parseInt(c.substring(1,3),16);var d=parseInt(c.substring(3,5),16);var a=parseInt(c.substring(5,7),16);return[e,d,a]}function rgbToRgba(a,b){return"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+b+")"}function RGBtoRGBA(h,f,c){if((f==void 0)&&(typeof h=="string")){h=h.replace(/^\s*#|\s*$/g,"");if(h.length==3){h=h.replace(/(.)/g,"$1$1")}f=parseInt(h.substr(2,2),16);c=parseInt(h.substr(4,2),16);h=parseInt(h.substr(0,2),16)}var e,d=(255-(e=Math.min(h,f,c)))/255;return{r:h=0|(h-e)/d,g:f=0|(f-e)/d,b:c=0|(c-e)/d,a:d=(0|1000*d)/1000,rgba:"rgba("+h+", "+f+", "+c+", "+d+")"}}function setOpacity(c,b){for(i=c.length-1;i>0;i--){if(c[i]==" "){break}}var a=c.substring(0,i+1)+b+")";return a}function EP_init(b,c){var a=$(CacheMan_load("event-picker"));a.find("#ep-title").text(b);a.data("count",c.length);$.each(c,function(g,d){var f=$(CacheMan_load("event-picker-item"));if(g==0){f.addClass("active")}var e=f.find(".popup-ep")[0];var h=d.eventDict;PopUp_setTitle(e,h.event_title);PopUp_setDescription(e,h.event_description);PopUp_setLocation(e,h.event_location);PopUp_setSection(e,h.section_id);PopUp_setType(e,h.event_type);PopUp_setDate(e,h.event_start);PopUp_setStartTime(e,h.event_start);PopUp_setEndTime(e,h.event_end);$.each(d.buttons,function(j,l){var k=$("<a>").addClass("white-link-btn").addClass("theme").css({display:"inline"});k.html(l.pretty);k.data("value",l.value);k.on("click",function(n){n.preventDefault();var m=$(this).closest(".item.active").index();a.trigger("ep.select",{eventID:d.eventID,eventDict:d.eventDict,button:$(this).data("value"),index:m})});f.find("#ep-item-controls").append(k)});f.css({height:window.innerHeight*0.55});a.find("#ep-container").append(f)});if(THEME=="w"){a.find(".theme").removeClass("dark")}else{a.find(".theme").addClass("dark")}a.find("#cancel_button").on("click",function(d){d.preventDefault();a.trigger("ep.cancel")});a.on("slid.bs.carousel",function(f){_EP_updateButtons(this);var e=$(this).find(".item.active").index();var d=c[e];$(this).trigger("ep.slid",{eventID:d.eventID,eventDict:d.eventDict,index:e})});_EP_updateButtons(a[0]);return a[0]}function EP_adjustPopUpSize(a){$(a).find(".popup-ep").each(function(){_PopUp_setBodyHeight(this)})}function _EP_updateButtons(c){var b=$(c);var a=b.find(".item.active").index();b.find(".ep-control").removeClass("disabled-btn");if(a==0){b.find(".left.ep-control").addClass("disabled-btn")}if(a==b.data("count")-1){b.find(".right.ep-control").addClass("disabled-btn")}}function EP_removeItemAtIndex(a,b){var d=$(a).data("count");var e=$(a).find(".item").filter(function(){return $(this).index()==b});if(e.hasClass("active")){var c=(b+1)%d;$(a).one("slid.bs.carousel",function(f){e.remove();$(this).data("count",d-1);_EP_updateButtons(this)});$(a).carousel(c);return}e.remove();$(a).data("count",d-1)}var eventsManager=null;var EventsMan_updateListeners=[];var EventsMan_onReadyListeners=[];var EventsMan_eventIDsChangeListener=[];var EVENTS_INIT=false;var EVENTS_READY=false;function EventsMan_init(){}function _EventsMan_new(){this.events={};this.order=[];this.lastSyncedTime=0;this.addedCount=0;this.updatedIDs=new Set();this.uncommitted={};this.hiddenIDs=new Set();this.changed=false;this.isIdle=true;this.showHidden=false;return this}function EventsMan_constructOrderArray(){eventsManager.order=[];$.each(eventsManager.events,function(a,b){eventsManager.order.push({event_start:b.event_start,event_id:a})});eventsManager.order.sort(function(d,c){return parseInt(d.event_start)-parseInt(c.event_start)})}function EventsMan_showHidden(a){if(typeof a!="undefined"){eventsManager.showHidden=a;_EventsMan_callUpdateListeners()}return eventsManager.showHidden}function EventsMan_getEventByID(a){return eventsManager.events[a]}function EventsMan_hasEvent(a){return(a in eventsManager.events)||(a in eventsManager.uncommitted)}function EventsMan_getEventIDForRange(g,c){var f=0;while(f<eventsManager.order.length&&eventsManager.order[f].event_start<g){f++}var b=f;while(f<eventsManager.order.length&&eventsManager.order[f].event_start<c){f++}var a=Math.min(f,eventsManager.order.length);var e=eventsManager.order.slice(b,a);var d=[];for(var f=0;f<e.length;f++){if(EventsMan_showHidden()||!EventsMan_eventIsHidden(e[f].event_id)){d.push(e[f].event_id)}}return d}function EventsMan_getAllEventIDs(){var a=[];$.each(eventsManager.events,function(b,c){if(EventsMan_showHidden()||!EventsMan_eventIsHidden(b)){a.push(b)}});return a}function EventsMan_hasUncommitted(a){return a in eventsManager.uncommitted}function EventsMan_getUncommitted(a){return eventsManager.uncommitted[a]}function EventsMan_addEvent(){var d=String(-1*++eventsManager.addedCount);var b=123;for(var a in SECTION_MAP){b=a;break}var c={event_id:d,event_group_id:d,event_title:"Event Name",event_type:"AS",event_start:moment().unix(),event_end:moment().minute(moment().minute()+50).unix(),event_description:"Event description \n Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",event_location:"Event location",course_id:-1,section_id:b,modified_user:USER_NETID,modified_time:moment().unix()};eventsManager.uncommitted[d]=c;return d}function EventsMan_deleteEvent(b,a){a=a||false;if(b in eventsManager.events){eventsManager.hiddenIDs.add(b);eventsManager.changed=true}if(b in eventsManager.uncommitted){eventsManager.uncommitted[b]=null;delete eventsManager.uncommitted[b]}if(b in eventsManager.updatedIDs){eventsManager.updatedIDs.remove(b)}if(!a){_EventsMan_callUpdateListeners()}}function EventsMan_deleteAllFutureEvents(d){var c=EventsMan_getEventByID(d);var b=moment.unix(c.event_start);b.year(b.year()+20);var a=EventsMan_getEventIDForRange(c.event_start,b.unix());$.each(a,function(e){var f=EventsMan_getEventByID(this);if(f.event_group_id==c.event_group_id&&f!=c){EventsMan_deleteEvent(this,true)}});EventsMan_deleteEvent(d)}function EventsMan_unhideEvent(b,a){a=a||false;if(b in eventsManager.events){eventsManager.hiddenIDs.remove(b);eventsManager.changed=true}if(!a){_EventsMan_callUpdateListeners()}}function EventsMan_unhideAllFutureEvents(d){var c=EventsMan_getEventByID(d);var b=moment.unix(c.event_start);b.year(b.year()+20);var a=EventsMan_getEventIDForRange(c.event_start,b.unix());$.each(a,function(e){var f=EventsMan_getEventByID(this);if(f.event_group_id==c.event_group_id&&f!=c){EventsMan_unhideEvent(this,true)}});EventsMan_unhideEvent(d)}function EventsMan_eventIsHidden(a){return a in eventsManager.hiddenIDs}function EventsMan_eventShouldBeShown(a){return !EventsMan_eventIsHidden(a)||EventsMan_showHidden()}function EventsMan_ready(){return EVENTS_READY}function EventsMan_commitChanges(c){var b=eventsManager.events[c];var a=eventsManager.uncommitted[c];eventsManager.events[c]=eventsManager.uncommitted[c];delete eventsManager.uncommitted[c];eventsManager.updatedIDs.add(c);EventsMan_constructOrderArray();if("recurrence_days" in b&&(!b.recurrence_days.equals(a.recurrence_days)||b.recurrence_interval!=a.recurrence_interval)){EventsMan_pushToServer(true)}_EventsMan_callUpdateListeners()}function EventsMan_cancelChanges(a){delete eventsManager.uncommitted[a];_EventsMan_callUpdateListeners()}function EventsMan_commitChangesToAllFutureEvents(g){var b=eventsManager.uncommitted[g];var c=eventsManager.events[g];var f=moment.unix(c.event_start);f.year(f.year()+20);var e=EventsMan_getEventIDForRange(c.event_start,f.unix());var a=moment.unix(b.event_start);var d=moment.unix(b.event_end);$.each(e,function(j){var l=EventsMan_getEventByID(this);if(l.event_group_id==c.event_group_id&&l!=c){l.event_title=b.event_title;l.event_description=b.event_description;l.event_location=b.event_location;l.section_id=b.section_id;l.event_type=b.event_type;l.modified_time=b.modified_time;l.modified_user=b.modified_user;var k=moment.unix(l.event_start).hour(a.hour());k.minute(a.minute());k.second(a.second());l.event_start=k.unix();var h=moment.unix(l.event_end).hour(d.hour());h.minute(d.minute());h.second(d.second());l.event_end=h.unix();eventsManager.updatedIDs.add(l.event_id)}});EventsMan_commitChanges(g)}function EventsMan_replaceUncommittedEventIDWithEvent(b,a){eventsManager.uncommitted[b]=null;delete eventsManager.uncommitted[b];eventsManager.uncommitted[a.event_id]=a;EventsMan_callEventIDsChangeListener(b,a.event_id);_EventsMan_callUpdateListeners()}function EventsMan_replaceEventIDWithEvent(b,a){eventsManager.events[b]=null;delete eventsManager.events[b];eventsManager.events[a.event_id]=a;if(EventsMan_hasUncommitted(b)){delete eventsManager.uncommitted[b]}EventsMan_callEventIDsChangeListener(b,a.event_id);_EventsMan_callUpdateListeners()}function EventsMan_pushToServer(a){}function EventsMan_pullFromServer(a){}function _EventsMan_callUpdateListeners(){$.each(EventsMan_updateListeners,function(a){this()})}function EventsMan_addUpdateListener(a){EventsMan_updateListeners.push(a)}function EventsMan_addOnReadyListener(a){if(EVENTS_READY){a();return}EventsMan_onReadyListeners.push(a)}function EventsMan_callOnReadyListeners(){$.each(EventsMan_onReadyListeners,function(a){this()});EventsMan_onReadyListeners=null}function EventsMan_addEventIDsChangeListener(a){EventsMan_eventIDsChangeListener.push(a)}function EventsMan_callEventIDsChangeListener(b,a){$.each(EventsMan_eventIDsChangeListener,function(c){this(b,a)})}function EventsMan_cloneEventDict(b){var a=JSON.parse(JSON.stringify(b));return a}function EventsMan_save(){if("localStorage" in window&&window.localStorage!==null){localStorage.setItem("eventsman.events",JSON.stringify(eventsManager.events));localStorage.setItem("eventsman.lastsyncedtime",eventsManager.lastSyncedTime);localStorage.setItem("eventsman.hidden",JSON.stringify(eventsManager.hiddenIDs.toArray()))}}function EventsMan_load(){if(!("localStorage" in window&&window.localStorage!==null)){return false}var a=localStorage.getItem("user");if(a!=USER_NETID){return false}var b=localStorage.getItem("eventsman.events");if(!b){return false}eventsManager.events=JSON.parse(b);var c=localStorage.getItem("eventsman.hidden");if(c){eventsManager.hiddenIDs=Set.prototype.fromArray(JSON.parse(c))}var d=localStorage.getItem("eventsman.lastsyncedtime");if(d){eventsManager.lastSyncedTime=d}EventsMan_constructOrderArray();return true}var MAIN_TIMEZONE="America/New_York";var DAYS_DICT=["M","Tu","W","Th","F","Sa","S"];var TYPE_MAP_INVERSE={assignment:"AS",exam:"EX",lab:"LA",lecture:"LE","office hours":"OH",precept:"PR","review session":"RS"};var TYPE_MAP={AS:"assignment",EX:"exam",LA:"lab",LE:"lecture",OH:"office hours",PR:"precept",RS:"review session"};String.prototype.escapeHTML=function(){var a={"&":"&amp;","<":"&lt;",">":"&gt;"};return this.replace(/[&<>]/g,function(b){return a[b]||b})};Array.prototype.contains=function(b){for(var c=0;c<this.length;c++){if(this[c]==b){return true}}return false};Array.prototype.find=function(b){for(var c=0;c<this.length;c++){if(this[c]==b){return c}}return -1};Array.prototype.equals=function(b){var c;for(c=0;c<this.length;c++){if(c>=b.length){return false}else{if(this[c]!=b[c]){return false}}}return c==b.length};var LO_TYPES={SUCCESS:"alert-success"};var LO_idMap=null;function LO_init(){LO_idMap={loading:new Set(),error:new Set()}}function LO_showLoading(b){if(typeof b=="undefined"){return}if(b in LO_idMap.loading){return}LO_idMap.loading.add(b);if($("#loading.active").length>0){return}var a=LO_getLoadingHTML();a.attr("id","loading");LO_insert(a)}function LO_hideLoading(b,a){if(typeof a=="undefined"){a=true}if(typeof b=="undefined"){return}LO_idMap.loading.remove(b);if(LO_idMap.loading.isEmpty()){LO_remove($("#loading.active"))}if(!a){return}if(b in LO_idMap.error){LO_idMap.error.remove(b);if(LO_idMap.error.isEmpty()){LO_remove($("#error.active"));LO_showTemporaryMessage("Connected :)",LO_TYPES.SUCCESS)}}}function LO_showError(b){if(typeof b=="undefined"){return}if(b in LO_idMap.error){return}LO_idMap.error.add(b);if($("#error.active").length>0){return}var a=LO_getLoadingHTML();a.attr("id","error");a.removeClass("alert-info").addClass("alert-danger");a.find("#loading-content").html("Error connecting.<br>Will keep trying");LO_insert(a)}function LO_showTemporaryMessage(b,a){var c=LO_getLoadingHTML();c.removeClass("alert-info").addClass(a);c.find("#loading-content").text(b);LO_insert(c);setTimeout(function(){LO_remove(c)},1.5*1000)}function LO_remove(a){a.on("transitionend",function(b){$(this).remove()});a.removeClass("active");a.removeClass("in")}function LO_insert(a){$("#indicators-container").append(a);a.addClass("active");a.addClass("in")}function LO_getLoadingHTML(){var a=$("<div>").addClass("indicator alert alert-dismissable alert-info");a.append($('<span id="loading-content">'));a.find("#loading-content").append('Loading...&nbsp;&nbsp;&nbsp;<i class="fa fa-spinner fa-spin"></i>');return a}var pinnedIDs=null;var mainID=null;var csrftoken=$.cookie("csrftoken");var COURSE_COLOR_MAP;var SECTION_COLOR_MAP;function UI_pin(a){if(UI_isMain(a)){UI_unsetMain()}pinnedIDs.add(a)}function UI_isPinned(a){return a in pinnedIDs}function UI_unpin(a){pinnedIDs.remove(a)}function UI_isMain(a){return mainID==a}function UI_setMain(a){if(UI_isPinned(a)){UI_unpin(a)}mainID=a}function UI_unsetMain(){mainID=null}function csrfSafeMethod(a){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(a))}function sameOrigin(b){var d=document.location.host;var e=document.location.protocol;var c="//"+d;var a=e+c;return(b==a||b.slice(0,a.length+1)==a+"/")||(b==c||b.slice(0,c.length+1)==c+"/")||!(/^(\/\/|http:|https:).*/.test(b))}function toTitleCase(a){return a.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()})}function br2nl(a){return a.replace(/(\n|\r)/g,"").replace(/<br>/g,"\n")}function nl2br(a){return a.replace(/(\n|\r)/g,"<br>")}function loadWhiteTheme(){$(".theme").removeClass("dark");$("#theme_css").attr("href","/static/cosmo/bootstrap.css")}function loadDarkTheme(){$(".theme").addClass("dark");$("#theme_css").attr("href","/static/cyborg/bootstrap.css")}var POPUP_HTML=null;var POPUP_CLASS="popup";var POPUP_URL="popup-template";var PopUp_closeListeners=[];var PopUp_editListeners=[];var PopUp_freedSpace=[];var PopUp_space=0;var POPUP_INIT=false;var POPUP_EDITDICT={"popup-loc":"event_location","popup-title":"event_title","popup-date":"event_date","popup-time-start":"event_start","popup-time-end":"event_end","popup-type":"event_type","popup-section":"section_id","popup-desc":"event_description","popup-repeat-end":"recurrence_end","popup-repeat-interval":"recurrence_interval"};var PopUp_Main_optFirstDrag=function(a){};var POPUP_MAIN_FIRSTDRAG=function(a){if(PopUp_isMain(a)){a.id="";PopUp_Main_optFirstDrag(a);UI_pin(PopUp_getID(a));UI_unsetMain();var b=a.getBoundingClientRect();$(a).css({height:b.height+"px",width:b.width+"px"});$(a).appendTo("body");$(a).css({top:b.top,left:b.left});PopUp_makeResizable(a);SB_hide()}};function PopUp_insertPopUp(b){var d;if(POPUP_HTML){d=POPUP_HTML}else{d=CacheMan_load(POPUP_URL)}if(b){SB_push(d)}else{$("body").append(d)}var c=$("#popup-main123");var a=function(){POPUP_MAIN_FIRSTDRAG(c);if(c.space){PopUp_freedSpace.push(c.space)}};c.draggable({handle:".panel > .panel-heading",containment:"#content_bounds",scroll:false,appendTo:"body",beforeStart:function(f,g){a()},zIndex:2000});c=c[0];c.id="popup-main";if(!b){var e;if(PopUp_freedSpace.length==0){e=++PopUp_space}else{e=PopUp_freedSpace.sort(function(g,f){return f-g}).pop()}c.id="";PopUp_makeResizable(c);leftPos=parseInt($(c).css("left"));topPos=parseInt($(c).css("top"));$(c).css("left",(leftPos+20*e)+"px").css("top",(topPos+20*e)+"px");c.space=e}c.onmousedown=function(){PopUp_giveFocus(this)};maxHeight=window.innerHeight-$(".navbar").height()-100;$(c).css("max-height",maxHeight+"px");_PopUp_setBodyHeight(c);PopUp_initialize(c);setTimeout(function(){PopUp_initialize_deferred(c)},300);$(c).find(".withtooltip").tooltip({});if(THEME=="w"){$(c).find(".theme").removeClass("dark")}else{$(c).find(".theme").addClass("dark")}return c}function PopUp_initialize(a){}function PopUp_initialize_deferred(a){}function PopUp_close(a){if(UI_isMain(PopUp_getID(a))){UI_unsetMain();SB_pop(a)}else{UI_unpin(PopUp_getID(a));$(a).remove()}SB_hideIfEmpty()}function PopUp_getMainPopUp(){var a=$("#popup-main");if(a.length>0){a=$("#popup-main")[0]}else{a=PopUp_insertPopUp(true)}return a}function PopUp_getPopUpByID(a){if($("."+POPUP_CLASS).find("#"+a).length>0){return $("."+POPUP_CLASS).find("#"+a).parent()[0]}else{return null}}function PopUp_getID(a){if(!a){return null}if(!("id" in $(a).find(".panel")[0])){return null}return $(a).find(".panel")[0].id}function PopUp_setID(a,c){var b=$(a).find(".panel")[0].id;$(a).find(".panel")[0].id=c;if(a.id=="popup-main"){UI_setMain(c)}else{UI_unpin(b);UI_pin(c)}}function _PopUp_setBodyHeight(b){var d=$(b).find(".panel-heading").css("height");var c=$(b).find(".panel-footer").not(".hide-footer").css("height");if(typeof c=="undefined"){c=0}var a=$(b).css("height");$(b).find(".panel-body").css("height",(parseInt(a)-parseInt(d))-parseInt(c)+"px")}function PopUp_giveFocus(b){if(!b){return}PopUp_loseFocus($("."+POPUP_CLASS).not(b));$(b).css("z-index","200");var a=$(b).find(".panel").data("my-color");$(b).find(".panel").addClass("panel-primary").removeClass("panel-default").css("border-color",a);$(b).find(".popup-title").parent().parent().css("opacity",1);_PopUp_setBodyHeight(b);$(document.activeElement).blur();if(UI_isMain(PopUp_getID(b))){SB_show()}}function PopUp_loseFocus(a){a.each(function(c){var b=$(this).find(".panel").data("default-border");var d=$(this).find(".panel").data("default-header");$(this).css("z-index","100").find(".panel").addClass("panel-default").removeClass("panel-primary").css("border-color",b);$(this).find(".popup-title").parent().parent().css("opacity",0.6);_PopUp_setBodyHeight($(this))})}function PopUp_giveFocusToID(a){popUp=$("."+POPUP_CLASS).find("#"+a).parent();PopUp_giveFocus(popUp)}function PopUp_hasFocus(a){return $(a).find(".panel").hasClass("panel-primary")}function PopUp_updateSize(a){$(a).find(".panel").css({width:$(a).css("width"),height:$(a).css("height")});_PopUp_setBodyHeight(a)}function PopUp_isMain(a){return a.id=="popup-main"}function PopUp_makeMain(a){a.id="popup-main";var c=PopUp_getID(a);if(UI_isPinned(c)){UI_unpin(c)}UI_setMain(c);try{$(a).find(".panel").resizable("destroy")}catch(b){}}function PopUp_hasMain(a){return $("#popup-main").length>0}function PopUp_makeResizable(a){$(a).find(".panel").resizable({stop:function(c,b){$(this).parent().css("height",$(this).css("height"));$(this).parent().css("width",$(this).css("width"));_PopUp_setBodyHeight(this)}})}function PopUp_addCloseListener(a){PopUp_closeListeners.push(a)}function PopUp_addEditListener(a){PopUp_editListeners.push(a)}function PopUp_callCloseListeners(a){$(PopUp_closeListeners).each(function(b){this(a)})}function PopUp_callEditListeners(c,b,a){$(PopUp_editListeners).each(function(d){this(c,b,a)})}function _PopUp_getPopUp(b){var a=b;while(!$(a).hasClass("popup")){a=$(a).parent()[0]}return a}function PopUp_map(a){$("."+POPUP_CLASS).not("#popup-main").each(function(b){a(this,false)});$("#popup-main").each(function(b){a(this,true)})}function PopUp_setColor(c,b){$(c).find(".panel").data("my-color",b);var a="#DDDDDD";var d="#F5F5F5";$(c).find(".panel").data("default-border",a);$(c).find(".panel").data("default-header",d);$(c).find(".popup-title").parent().parent().css("background-color",b).css("border-color",b);if(!PopUp_hasFocus(c)){$(c).find(".popup-title").parent().parent().css("opacity",0.6)}}var RF_ACTIVE=true;var RF_timeoutIDs=[];var RF_INTERVAL=10*1000;var RF_FUNCTIONS=[];var RF_MAX=1000000;var RF_COUNT=0;function RF_init(){$(window).on("mousemove click",function(){$.each(RF_timeoutIDs,function(a){window.clearTimeout(this)});RF_timeoutIDs=[];RF_ACTIVE=true;RF_timeoutIDs.push(window.setTimeout(function(){RF_ACTIVE=false},30*1000))});window.setInterval(function(){RF_COUNT=(RF_COUNT+1)%RF_MAX;RF_callRecurringFunctions(RF_COUNT)},RF_INTERVAL)}function RF_addRecurringFunction(b,a,c){RF_FUNCTIONS.push({recurringFunction:b,defaultInterval:parseInt(a/RF_INTERVAL),idleInterval:parseInt(c/RF_INTERVAL)})}function RF_callRecurringFunctions(a){$.each(RF_FUNCTIONS,function(c,b){if(!RF_ACTIVE&&(a%b.idleInterval)==0){b.recurringFunction()}else{if((a%b.defaultInterval)==0){b.recurringFunction()}}})}function SC_initWithChoices(b,c){$container=$("<div>").addClass("segmented-control").append($("<h5>"));$container.find("h5").text(b);var a=$("<div>").addClass("btn-group");$.each(c,function(d){var e=$("<button>").addClass("btn").addClass("btn-sm").text(this.pretty).data("value",this.value).on("click",function(f){f.preventDefault();SC_select(this)});a.append(e);if(this.selected||d==0){SC_select(e)}});$container.append(a);return $container[0]}function SC_setToChoices(a,b){$(a).find("button").each(function(d){for(var e=0;e<b.length;e++){var c=b[e];if(c.value==$(this).data("value")){if(c.selected){SC_select(this,true)}break}}})}function SC_removeAllFromContainer(a){$(a).find(".segmented-control").remove()}function SC_select(b,a){a=a||false;SC_unhighlight($(b).parent().find(".btn-primary"));SC_highlight(b);if(a){return}var c={};$(b).parent().find(".btn").each(function(d){c[$(this).data("value")]=$(this).hasClass("btn-primary")});$(b).trigger("select",c)}function SC_highlight(a){$(a).addClass("btn-primary")}function SC_unhighlight(a){$(a).removeClass("btn-primary")}function SC_isHighlighted(a){return $(a).hasClass("btn-primary")}function SCM_initWithChoices(a,c){var b=SC_initWithChoices(a,c);$(b).find("button").each(function(d){$(this).off("click");$(this).on("click",function(e){e.preventDefault();if(SC_isHighlighted(this)){SCM_deselect(this)}else{SCM_select(this)}});SCM_setToChoices(b,c)});return b}function SCM_select(a){SC_highlight(a);var b={};$(a).parent().find(".btn").each(function(c){b[$(this).data("value")]=$(this).hasClass("btn-primary")});$(a).trigger("select",b)}function SCM_deselect(a){SC_unhighlight(a);var b={};$(a).parent().find(".btn").each(function(c){b[$(this).data("value")]=$(this).hasClass("btn-primary")});$(a).trigger("select",b)}function SCM_setToChoices(a,b){$(a).find("button").each(function(d){SCM_deselect(this);for(var e=0;e<b.length;e++){var c=b[e];if(c.value==$(this).data("value")){if(c.selected){SCM_select(this)}break}}})}function SCP_initOnElement(b,a,c,f){if($(b).data("scp")){var e=$(b).data("scp");SC_setToChoices(e,f);return e}var d=SC_initWithChoices(null,f);$(d).find(".btn-group").addClass("btn-group-vertical").removeClass("btn-group");$(b).popover({title:c,placement:"left",html:true,content:d,trigger:"focus",container:$(a)});$(b).data("scp",d);return d}var Set=function(){};Set.prototype.size=0;Set.prototype.add=function(a){this[a]=true;this.size++};Set.prototype.remove=function(a){if(a in this){delete this[a];this.size--}};Set.prototype.fromArray=function(c){var a=new Set();for(var b=0;b<c.length;b++){a.add(c[b])}return a};Set.prototype.toArray=function(){var a=[];for(var b in this){if(typeof this[b]!="function"&&b!="size"){a.push(b)}}a.sort();return a};Set.prototype.contains=function(b){for(var c in b){if(!(c in this)){return false}}return true};Set.prototype.equals=function(b){return this.contains(b)&&b.contains(this)};Set.prototype.isEmpty=function(b){return this.size<=0};var SB_willCloseListeners=[];function SB_init(){$("#sidebar").droppable({drop:function(c,d){if(PopUp_hasMain()){var a=PopUp_getMainPopUp();PopUp_callCloseListeners(PopUp_getID(a));$(a).remove()}var b=d.draggable[0];$(b).detach().appendTo("#sb-left-container").css({width:"100%",height:"350px",left:"auto",top:"auto"});$(b).addClass("sb-left-content");$(b).addClass("in");PopUp_updateSize(b);PopUp_makeMain(b)},hoverClass:"hover-active"});$("#sidebar-target").droppable({over:function(a,b){SB_show()},out:function(a,b){if(SB_isEmpty()){SB_hide()}}})}function SB_isEmpty(){return $("#sidebar").find(".in").length==0}function SB_show(){$("#sidebar").addClass("in");$("#sb-handle").find(".glyphicon").addClass("glyphicon-chevron-right").removeClass("glyphicon-chevron-left")}function SB_hide(){SB_callWillCloseListeners();SB_unfill();$("#sidebar").removeClass("in");$("#sb-handle").find(".glyphicon").removeClass("glyphicon-chevron-right").addClass("glyphicon-chevron-left")}function SB_hideIfEmpty(){if(SB_isEmpty()){SB_hide()}}function SB_isShown(){return $("#sidebar").hasClass("in")}function SB_push(a){a=$(a).addClass("sb-left-content")[0];$("#sb-left-container").append(a);if(!SB_isShown()){SB_show()}setTimeout("$('#sb-left-container').find('.sb-left-content').addClass('in')",10)}function SB_pop(a){$(a).removeClass("in").on("transitionend",function(){$(a).remove()})}function SB_setMainContent(a){$(".sb-full-content").remove();a=$(a).addClass("sb-full-content")[0];$("#sb-full-container").append(a);setTimeout("$('#sb-full-container').find('.sb-full-content').addClass('in')",10)}function SB_fill(){$("#sidebar").addClass("full");disableAllInteractions()}function SB_unfill(){$("#sidebar").removeClass("full");SB_pop($(".sb-full-content"));enableAllInteractions()}function SB_isFilled(){return $("#sidebar").hasClass("full")}function SB_toggle(){if(SB_isShown()){SB_hide()}else{SB_show()}}function SB_addWillCloseListener(a){SB_willCloseListeners.push(a)}function SB_callWillCloseListeners(){$.each(SB_willCloseListeners,function(a){this()})}function Cal_init(){if(CAL_INIT){return}CAL_INIT=true;var a="410";Cal_options.height=a;Cal_options.header=false;Cal_options.weekends=false;Cal_options.columnFormat={month:"ddd",week:"ddd",day:"dddd M/d"};Cal_options.eventClick=function(g,c,b){if(g.highlighted==true){return}if(SHIFT_PRESSED){Cal_highlightEvent(g,true);var d=PopUp_insertPopUp(false);PopUp_giveFocus(d);return}var f=EventsMan_getEventByID(g.id).course_id;$($("#calendarui").fullCalendar("clientEvents",function(h){return !UI_isPinned(h.id)})).each(function(h){var j=EventsMan_getEventByID(this.id);if(j.course_id!=f){Cal_unhighlightEvent(this,false)}else{Cal_highlightEvent(this,false)}});Cal_highlightEvent(g,true);var e=EventsMan_getEventByID(g.id).course_id;CL_selectID(e);var d=PopUp_getMainPopUp();console.log(d);PopUp_giveFocus(d)};$("#calendarui").fullCalendar(Cal_options);EventsMan_addUpdateListener(function(){Cal_reload()});PopUp_addCloseListener(function(){Cal_reload()})}function Cal_reload(){LO_showLoading("cal loading");var a=EventsMan_getEnrolledEvents();Cal_eventSource.events=[];$.each(a,function(e){eventDict=EventsMan_getEventByID(this);var d=COURSE_COLOR_MAP[eventDict.course_id];if(!d){d=getUsableColor(eventDict.course_id)}var c=UI_isPinned(eventDict.course_id)||UI_isMain(eventDict.course_id);d=colorLuminance(d,FACTOR_LUM);var f;if(c){f=rgbToRgba(luminanceToRgb(d),1)}else{f=rgbToRgba(luminanceToRgb(d),FACTOR_TRANS)}Cal_eventSource.events.push({id:eventDict.event_id,title:CourseMan_getCourseByID(eventDict.course_id).course_primary_listing,start:moment.unix(eventDict.event_start).tz(MAIN_TIMEZONE).toISOString(),end:moment.unix(eventDict.event_end).tz(MAIN_TIMEZONE).toISOString(),myColor:COURSE_COLOR_MAP[eventDict.course_id],textColor:c?"#ffffff":d,backgroundColor:f,borderColor:"#ffffff"})});var b=moment.unix(CUR_SEM.start_date);b.week(b.week()+1);$("#calendarui").fullCalendar("gotoDate",b.year(),b.month(),b.date());$("#calendarui").fullCalendar("refetchEvents");LO_hideLoading("cal loading")}var CL_LOADING=false;function CL_init(){CourseMan_addUpdateListener(function(){CL_reload()});CL_reload();PopUp_addCloseListener(function(a){CL_unhighlight($("#"+a+".course-item.panel"))})}function CL_reload(){if(CL_LOADING){return}CL_LOADING=true;var a=$("#course-list")[0];a.innerHTML=null;$.each(CourseMan_getEnrolledCourses(),function(d){var c=CourseMan_getCourseByID(this);var e=$(CacheMan_load("/course-template")).appendTo(a);e.find(".course-title").text(c.course_listings)[0];var b=[];$.each(CourseMan_getEnrolledSectionIDs(this),function(f){var g=CourseMan_getSectionByID(this);if(g.section_name=="All Students"){return}b.push(g.section_name)});b.sort();e.find(".course-sections").text(b.join(", "));e.find(".panel")[0].id=this;e.find("a").on("click",function(f){f.preventDefault();CL_clickCourse(this)});if(UI_isMain(this)||UI_isPinned(this)){CL_highlight(e.find(".panel"))}CL_setColors(e,c)});if(THEME=="w"){$(".theme").removeClass("dark")}else{$(".theme").addClass("dark")}CL_LOADING=false}function CL_clickCourse(c){var a=$(c).find(".panel")[0];if(CL_isHighlighted(a)){var e=a.id;PopUp_giveFocusToID(e);var d=a.id;$.each($("#calendarui").fullCalendar("clientEvents"),function(f){var g=EventsMan_getEventByID(this.id);if(g.course_id!=d){Cal_unhighlightEvent(this,true);console.log("unhighlight "+g.course_id)}else{Cal_highlightEvent(this,true);console.log("highlight "+g.course_id)}});return}if(SHIFT_PRESSED){}CL_unhighlight($(".panel-primary.course-item").filter(function(){return !UI_isPinned(this.id)}));CL_highlight(a);var b=PopUp_getMainPopUp();PopUp_setToCourseID(b,a.id);PopUp_giveFocus(b);var d=a.id;$.each($("#calendarui").fullCalendar("clientEvents"),function(f){var g=EventsMan_getEventByID(this.id);if(g.course_id!=d){Cal_unhighlightEvent(this,true);console.log("unhighlight "+g.course_id)}else{Cal_highlightEvent(this,true);console.log("highlight "+g.course_id)}})}function CL_selectID(b){var a=$("#"+b+".panel.course-item").parent()[0];CL_clickCourse(a)}function CL_highlight(a){if(CL_isHighlighted(a)){return}$(a).addClass("panel-primary").removeClass("panel-default");$(a).css("border-color",$(a).data("course-color"))}function CL_unhighlight(a){if(!CL_isHighlighted(a)){return}$(a).addClass("panel-default").removeClass("panel-primary");$(a).css("border-color",$(a).data("default-border"))}function CL_isHighlighted(a){return $(a).hasClass("panel-primary")}function CL_setColors(b,d){var c=COURSE_COLOR_MAP[d.course_id];var a=$(b).find(".panel").css("border-color");$(b).find(".course-title").css("color",c);$(b).find(".panel").data("default-border",a);$(b).find(".panel").data("course-color",c)}var CourseManager=function(){};CourseManager.prototype.courseSectionsMap={};CourseManager.prototype.enrolledCourses=function(){var a=[];for(var b in this.courseSectionsMap){a.push(b)}return a};CourseManager.prototype.allCourses={};CourseManager.prototype.allSections={};CourseManager.prototype.isIdle=true;CourseManager.prototype.queue=[];CourseManager.prototype.modified=false;CourseManager.prototype.queries={};var courseManager=null;var CourseMan_updateListeners=[];var DEFAULT_SECTION_COLORS;function CourseMan_init(){courseManager=new CourseManager();CourseMan_pullEnrolledCourseIDs(function(){CourseMan_cacheEnrolledCourses()});setInterval(function(){CourseMan_pushChanges(true)},10*1000);CourseMan_addUpdateListener(function(){CourseMan_pushChanges(true)});$(window).on("beforeunload",function(){CourseMan_pushChanges(false)})}function CourseMan_getCourseByID(a){if(!(a in courseManager.allCourses)){CourseMan_pullCourseByID(a,false)}return courseManager.allCourses[a]}function CourseMan_getEnrolledCourses(){return courseManager.enrolledCourses()}function CourseMan_getEnrolledSectionIDs(a){return courseManager.courseSectionsMap[a]}function CourseMan_getSectionByID(a){return courseManager.allSections[a]}function CourseMan_courseEnrolled(a){return a in courseManager.courseSectionsMap}function CourseMan_enrollInCourseID(c){if(CourseMan_courseEnrolled(c)){return}var a=CourseMan_getCourseByID(c);var b=a.sections["all students"][0];courseManager.courseSectionsMap[c]=[b];courseManager.modified=true;CourseMan_callUpdateListeners()}function CourseMan_unenrollCourseID(a){if(!CourseMan_courseEnrolled(a)){return}delete courseManager.courseSectionsMap[a];courseManager.modified=true;CourseMan_callUpdateListeners()}function CourseMan_sectionEnrolled(c,b){var a=false;$.each(courseManager.courseSectionsMap[c],function(d){if(this==b){a=true;return false}});return a}function CourseMan_enrollSectionID(b,a){if(CourseMan_sectionEnrolled(b,a)){return}courseManager.courseSectionsMap[b].push(a);courseManager.modified=true;CourseMan_callUpdateListeners()}function CourseMan_unenrollSectionID(c,b){if(!CourseMan_sectionEnrolled(c,b)){return}var d=courseManager.courseSectionsMap[c];var a=d.find(b);d.splice(a,1);courseManager.modified=true;CourseMan_callUpdateListeners()}function CourseMan_pullEnrolledCourseIDs(a){if(!courseManager.isIdle){courseManager.queue.push({call:CourseMan_pullEnrolledCourses,arg1:a});return}courseManager.isIdle=false;$.ajax("/get/sections",{dataType:"json",success:function(b){courseManager.courseSectionsMap=b;courseManager.isIdle=true;if(a){a()}CourseMan_handleQueue();CourseMan_callUpdateListeners()},error:function(b){courseManager.isIdle=true;CourseMan_handleQueue()}})}function CourseMan_pullCourseByID(b,a){$.ajax("/get/course/"+b,{dataType:"json",async:a,loadingIndicator:false,success:function(c){CourseMan_saveCourseDict(c);CourseMan_callUpdateListeners()}})}function CourseMan_pushChanges(b){if(!courseManager.modified){return}if(!courseManager.isIdle){courseManager.queue.push({call:CourseMan_pushChanges,arg1:b});return}courseManager.isIdle=false;var a=JSON.stringify(courseManager.courseSectionsMap);$.ajax("/put/sections",{async:b,type:"POST",data:{sections:a},success:function(c){courseManager.isIdle=true;if(a==JSON.stringify(courseManager.courseSectionsMap)){courseManager.modified=false}CourseMan_handleQueue();LO_showTemporaryMessage("Saved",LO_TYPES.SUCCESS)},error:function(c){courseManager.isIdle=true;CourseMan_handleQueue()}})}function CourseMan_cacheEnrolledCourses(){$.each(courseManager.enrolledCourses(),function(a,b){if(!(b in courseManager.allCourses)){CourseMan_pullCourseByID(b,true)}})}function CourseMan_handleQueue(){if(courseManager.queue.length>0){var a=courseManager.queue.shift();a.call(a.arg1)}}function CourseMan_pullAutoComplete(b,a){if(b.term in courseManager.queries){if(a){a(courseManager.queries[b.term])}return}$.getJSON("/api/classlist",b,function(d,c,e){$.each(d,function(f){CourseMan_saveCourseDict(this)});courseManager.queries[b.term]=d;if(a){a(d)}})}function CourseMan_saveCourseDict(a){for(var c in a.sections){for(var b in a.sections[c]){var d=a.sections[c][b];courseManager.allSections[d.section_id]=d;a.sections[c][b]=d.section_id}}courseManager.allCourses[a.course_id]=a}function CourseMan_addUpdateListener(a){CourseMan_updateListeners.push(a)}function CourseMan_callUpdateListeners(){$.each(CourseMan_updateListeners,function(a){this()})}function EventsMan_init(){if(EVENTS_INIT){return}EVENTS_INIT=true;eventsManager=new _EventsMan_new();eventsManager.loadedCourseIDs=new Set();EventsMan_pullFromServer(function(){EVENTS_READY=true;EventsMan_callOnReadyListeners()});CourseMan_addUpdateListener(function(){EventsMan_pullFromServer();_EventsMan_callUpdateListeners()})}function EventsMan_pullFromServer(b){if(!eventsManager.isIdle){return}var e=CourseMan_getEnrolledCourses();var c=[];for(var d=0;d<e.length;d++){var g=e[d];if(!(g in eventsManager.loadedCourseIDs)){c.push(g)}}if(c.length==0){return}eventsManager.isIdle=false;var f=moment.unix(CUR_SEM.start_date);var a=moment.unix(CUR_SEM.start_date);f.week(f.week()+1);a.week(f.week()+1);$.ajax("/get/bycourses/0/"+f.unix()+"/"+a.unix(),{dataType:"json",type:"GET",data:{courseIDs:JSON.stringify(e)},success:function(l){var j=l;if(l.length==0){eventsManager.isIdle=true;_EventsMan_callUpdateListeners();return}for(var k=0;k<j.length;k++){var h=j[k];eventsManager.events[h.event_id]=h}EventsMan_constructOrderArray();eventsManager.lastSyncedTime=moment().unix();for(var k=0;k<c.length;k++){eventsManager.loadedCourseIDs.add(c[k])}eventsManager.isIdle=true;if(b!=null){b()}_EventsMan_callUpdateListeners()},error:function(h){eventsManager.isIdle=true}})}function EventsMan_getEnrolledEvents(){var a=[];$.each(CourseMan_getEnrolledCourses(),function(c){$.each(CourseMan_getEnrolledSectionIDs(this),function(d){a.push(parseInt(this))})});var b=[];$.each(eventsManager.events,function(c,d){if(a.contains(d.section_id)){b.push(c)}});return b}KEY_UP=38;KEY_DOWN=40;KEY_LEFT=37;KEY_RIGHT=39;KEY_SQ_BRACE_R=221;KEY_SQ_BRACE_L=219;KEY_SHIFT=16;var SHIFT_PRESSED=false;$(document).keydown(function(b){var a=b.keyCode||b.which;switch(a){case KEY_SHIFT:SHIFT_PRESSED=true;break}});$(document).keyup(function(){SHIFT_PRESSED=false});var DEFAULT_SECTION_COLORS;var COURSE_COLOR_MAP={};var USABLE_COLORS=[];$(init);function init(){pinnedIDs=new Set();moment.tz.add({zones:{"America/New_York":["-4:56:2 - LMT 1883_10_18_12_3_58 -4:56:2","-5 US E%sT 1920 -5","-5 NYC E%sT 1942 -5","-5 US E%sT 1946 -5","-5 NYC E%sT 1967 -5","-5 US E%sT"]},rules:{US:["1918 1919 2 0 8 2 0 1 D","1918 1919 9 0 8 2 0 0 S","1942 1942 1 9 7 2 0 1 W","1945 1945 7 14 7 23 1 1 P","1945 1945 8 30 7 2 0 0 S","1967 2006 9 0 8 2 0 0 S","1967 1973 3 0 8 2 0 1 D","1974 1974 0 6 7 2 0 1 D","1975 1975 1 23 7 2 0 1 D","1976 1986 3 0 8 2 0 1 D","1987 2006 3 1 0 2 0 1 D","2007 9999 2 8 0 2 0 1 D","2007 9999 10 1 0 2 0 0 S"],NYC:["1920 1920 2 0 8 2 0 1 D","1920 1920 9 0 8 2 0 0 S","1921 1966 3 0 8 2 0 1 D","1921 1954 8 0 8 2 0 0 S","1955 1966 9 0 8 2 0 0 S"]},links:{}});LO_init();$.ajaxSetup({beforeSend:function(b,a){if(!csrfSafeMethod(a.type)&&sameOrigin(a.url)){b.setRequestHeader("X-CSRFToken",csrftoken)}if(a.loadingIndicator==false){return}LO_showLoading(a.url)}});$(document).ajaxSuccess(function(b,c,a){LO_hideLoading(a.url)});$(document).ajaxError(function(b,c,a){LO_hideLoading(a.url,false);if(a.loadingIndicator==false){return}LO_showError(a.url)});SB_profile_init();CacheMan_init();CourseMan_init();EventsMan_init();Cal_init();PopUp_init();CL_init();UP_init();SECTION_COLOR_MAP=JSON.parse(CacheMan_load("/get/section-colors"));DEFAULT_SECTION_COLORS=JSON.parse(CacheMan_load("/get/default-section-colors"));courseColorMap_init();usableColor_init();if(THEME=="w"){loadWhiteTheme()}else{loadDarkTheme()}}function enableAllInteractions(){}function csrfSafeMethod(a){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(a))}function sameOrigin(b){var d=document.location.host;var e=document.location.protocol;var c="//"+d;var a=e+c;return(b==a||b.slice(0,a.length+1)==a+"/")||(b==c||b.slice(0,c.length+1)==c+"/")||!(/^(\/\/|http:|https:).*/.test(b))}function courseColorMap_init(){$.each(SECTION_COLOR_MAP,function(a,b){COURSE_COLOR_MAP[b.course_id]=b.color})}function usableColor_init(){$.each(DEFAULT_SECTION_COLORS,function(c,a){var b=true;$.each(COURSE_COLOR_MAP,function(d,e){if(e==a){b=false;return false}});if(b){USABLE_COLORS.push(a)}})}function getUsableColor(b){var a=USABLE_COLORS.shift();if(!a){a=DEFAULT_SECTION_COLORS[0]}COURSE_COLOR_MAP[b]=a;return a}POPUP_CLASS="popup-course";POPUP_URL="/popup-course-template";function PopUp_init(){if(POPUP_INIT){return}POPUP_INIT=true;var a=$.ui.draggable.prototype._mouseStart;$.ui.draggable.prototype._mouseStart=function(c,d,b){this._trigger("beforeStart",c,this._uiHash());a.apply(this,[c,d,b])};topPos=0;height=window.innerHeight-topPos+300;$("#content_bounds").css("top",topPos+"px").css("height",height).css("left","-20%").css("width","140%");$(window).on("resize",function(b){topPos=0;height=window.innerHeight-topPos+300;$("#content_bounds").css("top",topPos+"px").css("height",height).css("left","-20%").css("width","140%")})}function PopUp_initialize(a){$(a).find("#delete_button").on("click",function(b){b.preventDefault();var c=PopUp_getID(a);PopUp_callCloseListeners(c);PopUp_close(a);CourseMan_unenrollCourseID(c)})}function PopUp_setToCourseID(c,d){PopUp_setID(c,d);var b=CourseMan_getCourseByID(d);if(!b){console.log("errorneous course id");return}var a=COURSE_COLOR_MAP[d];if(!a){a=getUsableColor(d)}PopUp_setListing(c,b.course_listings);PopUp_setTitle(c,b.course_title);PopUp_setDescription(c,b.course_description);PopUp_setColor(c,a);SC_removeAllFromContainer(c);var e=CourseMan_getEnrolledSectionIDs(d);$.each(b.sections,function(g,j){if(g=="all students"){return}var k=[];var h=false;$.each(j,function(l){var m=CourseMan_getSectionByID(this);k.push({value:m.section_id,pretty:m.section_name,selected:e.contains(m.section_id)});h|=e.contains(m.section_id)});k.sort(function(m,l){return m.pretty.localeCompare(l.pretty)});var f=SC_initWithChoices(toTitleCase(g),k);if(!h){CourseMan_enrollSectionID(d,k[0].value)}$(c).find("#sections-container").append(f);$(f).on("select",function(l,m){$.each(m,function(o,n){if(n){CourseMan_enrollSectionID(d,o)}else{CourseMan_unenrollSectionID(d,o)}});CL_selectID(d)})})}function PopUp_setListing(a,b){$(a).find("#popup-listing").text(b)}function PopUp_setTitle(a,b){$(a).find("#popup-title").text(b)}function PopUp_setDescription(a,b){$(a).find("#popup-desc").html(nl2br(b))}function PopUp_clickedClose(a){var b=_PopUp_getPopUp(a);if(PopUp_getID(b)){PopUp_callCloseListeners(PopUp_getID(b))}PopUp_close(b)}$(function(){$("#class").autocomplete({minLength:2,source:function(c,a){var b=c.term;CourseMan_pullAutoComplete(c,function(e){var d=[];$.each(e,function(f){d.push({id:this.course_id,value:this.course_listings,label:this.course_listings,desc:this.course_title})});a(d)})},select:function(a,b){var c=b.item.id;CourseMan_enrollInCourseID(c);$("#class").val("");CL_selectID(c);return false}}).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append("<a>"+b.label+"<br>"+b.desc+"</a>").appendTo(a)}});function SB_profile_init(){$("#sidebar").droppable({drop:function(c,d){if(PopUp_hasMain()){var a=PopUp_getMainPopUp();PopUp_callCloseListeners(PopUp_getID(a));$(a).remove()}var b=d.draggable[0];$(b).detach().appendTo("#sb-left-container").css({width:"100%",height:"550px",left:"auto",top:"auto"});$(b).addClass("sb-left-content");$(b).addClass("in");PopUp_updateSize(b);PopUp_makeMain(b)},hoverClass:"hover-active"});$("#sidebar-target").droppable({over:function(a,b){SB_show()},out:function(a,b){if(SB_isEmpty()){SB_hide()}}})}function UP_init(){$("#first_name_box").val(USER.first_name);$("#last_name_box").val(USER.last_name);$("#first_name_box").on("change",function(a){USER.first_name=$(this).val()});$("#last_name_box").on("change",function(a){USER.last_name=$(this).val()});$(window).on("beforeunload",function(a){$.ajax("/put/user",{async:false,dataType:"json",type:"POST",data:{user:JSON.stringify(USER)}})})};